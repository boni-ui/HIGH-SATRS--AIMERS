<script>
const CLOUD_NAME="dj8xycoww";
const params=new URLSearchParams(window.location.search);
const subject=params.get("subject")||"Mathematics";
const form=params.get("form")||"Form 1";
const type = "papers";
document.getElementById("paper-title").innerText=`Papers: ${subject} - ${form}`;
const papersContainer=document.getElementById("papers-container");
const jsonKey = `${type}_${form}_${subject}`;

async function loadPapers(){
  papersContainer.innerHTML="<p style='text-align:center;color:gray;'>Loading papers...</p>";
  try{
    const res=await fetch(`https://res.cloudinary.com/${CLOUD_NAME}/raw/upload/${jsonKey}.json`);
    if(!res.ok){ papersContainer.innerHTML=`<p style="text-align:center;color:gray;">No papers found for ${subject} - ${form}</p>`; return;}
    const resources = await res.json();
    if(resources.length===0){ papersContainer.innerHTML=`<p style="text-align:center;color:gray;">No papers uploaded yet for ${subject} - ${form}</p>`; return;}
    papersContainer.innerHTML="";
    resources.forEach(fileUrl=>{
      const fileName=decodeURIComponent(fileUrl.split("/").pop());
      const card=document.createElement("div");
      card.className="paper-card";
      card.innerHTML=`<h3><i class="fas fa-file-pdf"></i> ${fileName}</h3>
        <div style="margin-top:10px;">
          <a href="${fileUrl}" target="_blank"><i class="fas fa-eye"></i> View</a> |
          <a href="${fileUrl}" download><i class="fas fa-download"></i> Download</a>
        </div>`;
      papersContainer.appendChild(card);
    });
  }catch(e){ console.error(e); papersContainer.innerHTML=`<p style="color:red;text-align:center;">Error loading papers</p>`;}
}
loadPapers();
</script>