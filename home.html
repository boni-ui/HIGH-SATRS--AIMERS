<!DOCTYPE html>  <html lang="en">    <head>    
<meta charset="UTF-8">    
<meta name="viewport" content="width=device-width, initial-scale=1.0">    
<title>High Stars Aimers - Home</title>    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">    
<style>    
:root {    
    --primary-color: #3b4cca;    
    --secondary-color: #00b4d8;    
    --accent-color: #ff6f61;    
    --background-dark: #f5f7fa;    
    --card-background: #ffffff;    
    --text-light: #333;    
    --border-color: #e2e8f0;    
    --hover-color: #f0f4ff;
}  html, body {  
margin: 0; padding: 0;  
font-family: 'Segoe UI', sans-serif;  
background-color: var(--background-dark);  
color: var(--text-light);  
}  * { box-sizing: border-box; }
h1,h2,h3,h4 { margin-bottom: 10px; }
a { text-decoration: none; color: inherit; }
main { display: flex; min-height: calc(100vh - 70px); }

/* HEADER */
.header {
display: flex; align-items: center;
padding: 10px 30px;
background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
color: #fff; font-size: 1.5rem; font-weight: bold;
height: 70px; position: sticky; top: 0; z-index: 1000;
box-shadow: 0 3px 10px rgba(0,0,0,0.15);
border-bottom: 2px solid var(--secondary-color);
}

/* SIDEBAR */
.sidebar {
width: 300px;
background-color: var(--card-background);
padding: 20px;
border-right: 1px solid var(--border-color);
display: flex; flex-direction: column; gap: 20px;
position: sticky; top: 70px; height: fit-content;
border-radius: 0 15px 15px 0;
box-shadow: 2px 0 10px rgba(0,0,0,0.05);
}
.user-profile {
text-align: center; margin-bottom: 20px;
padding-bottom: 20px; border-bottom: 1px solid var(--border-color);
}
.user-profile img {
width: 100px; height: 100px; border-radius: 50%;
border: 3px solid var(--secondary-color);
object-fit: cover; transition: transform 0.3s;
cursor: pointer; /* To indicate it's clickable for upload */
}
.user-profile img:hover { transform: scale(1.05); }
.user-profile h3 { margin-top: 10px; font-size: 1.5rem; color: var(--primary-color); }
.user-profile p { color: #666; font-size: 0.9rem; }

/* Profile Buttons Container */
.profile-actions {
display: flex;
gap: 10px;
}
.profile-actions button {
flex-grow: 1;
padding: 10px;
font-weight: bold;
border: none;
border-radius: 8px;
cursor: pointer;
transition: background-color 0.3s, transform 0.1s;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* View Profile Button */
#viewProfileButton {
background-color: var(--primary-color);
color: white;
}
#viewProfileButton:hover {
background-color: #2b3a9e;
transform: translateY(-2px);
}

/* Sign Out Button */
#signOutButton {
background-color: var(--accent-color); /* Red color for sign out */
color: white;
box-shadow: 0 2px 5px rgba(255, 111, 97, 0.4);
}
#signOutButton:hover {
background-color: #e55a5a;
transform: translateY(-2px);
}

/* Profile Details Section */
#profileDetails {
display: none; /* Initially hidden */
text-align: left;
background: var(--card-background);
border-radius: 10px;
padding: 15px;
border: 1px solid var(--border-color);
box-shadow: 0 4px 8px rgba(0,0,0,0.05);
}
#profileDetails h4 {
color: var(--primary-color);
margin-bottom: 10px;
border-bottom: 1px solid var(--border-color);
padding-bottom: 5px;
}
#profileDetails p {
margin: 5px 0;
font-size: 0.95rem;
color: var(--text-light);
}
#profileDetails span {
font-weight: bold;
color: var(--primary-color);
}

/* Status Message Area */
#uploadStatus {
margin-top: 10px;
font-size: 0.9rem;
color: var(--primary-color);
}

.sidebar-section {
background: var(--hover-color);
border-radius: 15px; padding: 15px; text-align: center;
border: 1px solid var(--border-color);
}

/* MAIN CONTENT */
.content-area {
flex-grow: 1; padding: 25px;
display: flex; flex-direction: column; gap: 25px;
max-width: 1000px; margin: 0 auto;
}
.announcement-banner {
padding: 15px;
background: linear-gradient(120deg, var(--secondary-color), var(--primary-color));
color: #fff; text-align: center; font-weight: bold;
border-radius: 12px;
box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}
.resource-card {
background: var(--card-background);
border-radius: 15px; padding: 25px;
border: 1px solid var(--border-color);
display: flex; flex-direction: column; gap: 12px;
transition: all 0.3s; cursor: pointer; text-align: center;
box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}
.resource-card:hover {
transform: translateY(-6px);
box-shadow: 0 10px 20px rgba(0,0,0,0.08);
background: var(--hover-color);
}
.resource-card h4 { margin: 0; font-size: 1.3rem; color: var(--primary-color); }
.resource-card p { color: #666; font-size: 0.95rem; }

/* FOOTER */
.footer {
padding: 20px;
background-color: var(--card-background);
text-align: center;
border-top: 2px solid var(--secondary-color);
color: #666;
border-radius: 15px 15px 0 0;
box-shadow: 0 -3px 8px rgba(0,0,0,0.05);
}
.social-icons a {
margin: 0 10px; font-size: 22px;
color: var(--secondary-color); transition: transform 0.3s;
}
.social-icons a:hover {
transform: scale(1.2); color: var(--accent-color);
}

@media (max-width: 1000px) {
main { flex-direction: column; }
.sidebar {
width: 100%; border-right: none;
border-bottom: 1px solid var(--border-color);
border-radius: 0; padding: 15px; position: static;
}
}
</style>

</head>  <body>  <div class="header">High Stars Aimers</div>  <main>    
  <aside class="sidebar">    
    <div class="user-profile">    
      <img id="userProfilePic" src="https://via.placeholder.com/100/00b4d8/FFFFFF?text=P" alt="Profile Picture">    
      <input type="file" id="imageUpload" accept="image/*" style="display: none;">  <h3 id="welcomeMessage">Loading...</h3>    
  <p id="userEmail">Loading email...</p>    
  <div id="uploadStatus">Click image to upload photo</div>    
</div>    <div class="profile-actions">    
    <button id="viewProfileButton">    
        <i class="fas fa-user-circle"></i> View Profile    
    </button>    
    <button id="signOutButton">    
        <i class="fas fa-sign-out-alt"></i> Sign Out    
    </button>    
</div>    <div id="profileDetails">    
    <h4>User Profile Details</h4>    
    <p><span>Username:</span> <span id="profileUsername"></span></p>    
    <p><span>Email:</span> <span id="profileEmail"></span></p>    
    <p><span>Account Status:</span> <span id="profileStatus"></span></p>    
    <p><span>Registration Date:</span> <span id="profileRegDate"></span></p>    
    <p><span>Last Login:</span> <span id="profileLastLogin"></span></p>    
</div>    <div class="sidebar-section">    
  <h4>Today's Tip</h4>    
  <p id="today-tip-text">"Break down large tasks into smaller, manageable chunks."</p>    
</div>    </aside>    <div class="content-area">    
    <div class="announcement-banner">    
      <i class="fas fa-bullhorn"></i> New updates are here! Check out the latest past papers.    
    </div>  <h2>Browse Resources</h2>    <a href="subjects.html">    
  <div class="resource-card">    
    <h4><i class="fas fa-book"></i> Browse by Subject</h4>    
    <p>Explore all subjects including Mathematics, Physics, Chemistry, Biology, and more.</p>    
  </div>    
</a>    <a href="papers.html">    
  <div class="resource-card">    
    <h4><i class="fas fa-file-alt"></i> Browse by Paper</h4>    
    <p>View all available past papers organized by subject and year.</p>    
  </div>    
</a>    <div class="resource-card">    
  <h4><i class="fas fa-question-circle"></i> Quiz Master</h4>    
  <p>Test your knowledge with interactive quizzes on various topics.</p>    
</div>    <div class="resource-card">    
  <h4><i class="fas fa-stopwatch"></i> Study Timer</h4>    
  <p>Use the Pomodoro timer to manage your study sessions effectively.</p>    
</div>    <div class="resource-card">    
  <h4><i class="fas fa-comments"></i> Ask a Question</h4>    
  <p>Get answers from the community or instructors on your study queries.</p>    
</div>    <div class="resource-card">    
  <h4><i class="fas fa-bug"></i> Report a Bug</h4>    
  <p>Help us improve by reporting any issues or bugs you find.</p>    
</div>    </div>    
</main>  <footer class="footer">    
  <div class="social-icons">    
    <a href="https://www.facebook.com/profile.php?id=61579327734565"><i class="fab fa-facebook"></i></a>    
    <a href="https://www.instagram.com/b.boni.mbugua?igsh=MTJ2Nm13OXl2ajd6dw=="><i class="fab fa-instagram"></i></a>    
    <a href="https://x.com/mbugua_bon60636?s=09"><i class="fa-brands fa-x-twitter"></i></a>    
    <a href="https://www.youtube.com/@BoniMbugua"><i class="fab fa-youtube"></i></a>    
    <a href="https://tiktok.com/@bonimbugua346"><i class="fab fa-tiktok"></i></a>    
    <a href="https://wa.me/254762187843"><i class="fab fa-whatsapp"></i></a>    
  </div>    
  <div class="footer-links">    
    <a href="#">About Us</a> | <a href="#">FAQs</a> | <a href="#">Terms & Conditions</a>    
  </div>    
  <p>&copy; 2025 High Stars Aimers. All Rights Reserved.</p>    
</footer>  <script type="module">    
    // --- Firebase Modular Imports (v9+) ---    
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";    
    import {     
        getAuth,     
        onAuthStateChanged,     
        signOut,    
        updateProfile // NEW: for updating photoURL    
    } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";    
    import {    
        getStorage,     
        ref,     
        uploadBytes,     
        getDownloadURL // NEW: for file storage    
    } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js";    // --- YOUR FIREBASE CONFIGURATION (The one you provided) ---    
const firebaseConfig = {    
  apiKey: "AIzaSyDhJD5Ux22U393z6RqT4Nv570jqoNrg7Xc",    
  authDomain: "high-stars-aimers-5972f.firebaseapp.com",    
  projectId: "high-stars-aimers-5972f",    
  storageBucket: "high-stars-aimers-5972f.firebasestorage.app", // Used for Storage    
  messagingSenderId: "233345875942",    
  appId: "1:233345875942:web:0b21df2fd59b744d2ce027",    
  measurementId: "G-JEV6M3EP1D"    
};    

// --- Initialization ---    
const app = initializeApp(firebaseConfig);    
const auth = getAuth(app);     
const storage = getStorage(app); // Initialize Storage    
    
// --- DOM Elements ---    
const welcomeMessage = document.getElementById('welcomeMessage');    
const userEmailElement = document.getElementById('userEmail');    
const userProfilePic = document.getElementById('userProfilePic');    
const imageUpload = document.getElementById('imageUpload');    
const uploadStatus = document.getElementById('uploadStatus');    
const signOutButton = document.getElementById('signOutButton');    
const viewProfileButton = document.getElementById('viewProfileButton');    
const profileDetails = document.getElementById('profileDetails');    
    
// Profile Detail Elements    
const profileUsername = document.getElementById('profileUsername');    
const profileEmail = document.getElementById('profileEmail');    
const profileStatus = document.getElementById('profileStatus');    
const profileRegDate = document.getElementById('profileRegDate');    
const profileLastLogin = document.getElementById('profileLastLogin');    

// Default Profile Image URL (if no photoURL is set)    
const DEFAULT_PIC = 'https://via.placeholder.com/100/00b4d8/FFFFFF?text=P';    


// 1. Authentication Status Listener (Auth Guard & Profile Display)    
onAuthStateChanged(auth, (user) => {    
    if (user) {    
        // Get user details    
        const email = user.email || "N/A";    
        const emailPart = email.substring(0, email.indexOf('@'));    
        const displayName = emailPart.charAt(0).toUpperCase() + emailPart.slice(1);    
            
        const creationDate = new Date(user.metadata.creationTime).toLocaleDateString();    
        const lastSignInDate = new Date(user.metadata.lastSignInTime).toLocaleDateString();    
            
        // Display basics    
        welcomeMessage.textContent = `Welcome, ${displayName}!`;    
        userEmailElement.textContent = email;    
            
        // Set profile picture (or default if null)    
        userProfilePic.src = user.photoURL || DEFAULT_PIC;    

        // Update Profile Detail section    
        profileUsername.textContent = displayName;    
        profileEmail.textContent = email;    
        profileStatus.textContent = user.emailVerified ? 'Verified' : 'Unverified';    
        profileRegDate.textContent = creationDate;    
        profileLastLogin.textContent = lastSignInDate;    

    } else {    
        // User is signed out or not logged in, redirect to login page    
        window.location.href = "signin1.html";    
    }    
});    

// 2. Sign Out Logic    
signOutButton.addEventListener('click', () => {    
    signOut(auth).then(() => {    
        // Redirect is handled by the onAuthStateChanged listener    
        console.log("User signed out successfully.");    
    }).catch((error) => {    
        console.error("Sign out error:", error);    
        alert("Error signing out. Please try again.");    
    });    
});    
    
// 3. Toggle Profile Details Logic    
viewProfileButton.addEventListener('click', () => {    
    // Toggle the display style    
    const isHidden = profileDetails.style.display === 'none' || profileDetails.style.display === '';    
    profileDetails.style.display = isHidden ? 'block' : 'none';    
        
    // Change button text/icon based on state    
    viewProfileButton.innerHTML = isHidden     
        ? '<i class="fas fa-times-circle"></i> Hide Profile'     
        : '<i class="fas fa-user-circle"></i> View Profile';    
});    

// 4. Image Upload Logic (FULLY FUNCTIONAL)    
userProfilePic.addEventListener('click', () => {    
    imageUpload.click(); // Trigger the hidden file input    
});    

imageUpload.addEventListener('change', (event) => {    
    const file = event.target.files[0];    
    const user = auth.currentUser;    

    if (!file || !user) {    
        uploadStatus.textContent = "No file selected or user not logged in.";    
        return;    
    }    

    // Set the file path in Firebase Storage to be unique (UserID/profile.jpg)    
    const storagePath = `profile_pictures/${user.uid}/profile.jpg`;    
    const imageRef = ref(storage, storagePath);    

    uploadStatus.style.color = 'var(--primary-color)';    
    uploadStatus.textContent = "Uploading image...";    

    // 1. Upload the file    
    uploadBytes(imageRef, file)    
        .then((snapshot) => {    
            uploadStatus.textContent = "Upload complete. Getting URL...";    
                
            // 2. Get the permanent download URL    
            return getDownloadURL(snapshot.ref);    
        })    
        .then((url) => {    
            // 3. Update the user's photoURL in Firebase Auth    
            return updateProfile(user, {    
                photoURL: url    
            });    
        })    
        .then(() => {    
            // 4. Update the image element and status message    
            userProfilePic.src = auth.currentUser.photoURL; // Reloads the image from the new URL    
            uploadStatus.style.color = 'green';    
            uploadStatus.textContent = "Profile picture saved successfully!";    
        })    
        .catch((error) => {    
            console.error("Profile picture update failed:", error);    
            uploadStatus.style.color = 'red';    
            uploadStatus.textContent = `Error: Could not save image. Check console.`;    
            if (error.code === 'storage/unauthorized') {    
                uploadStatus.textContent += " (Check Firebase Storage Rules!)";    
            }    
        });    
});

</script>  </body>

</html>
