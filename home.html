<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>High Stars Aimers - Home</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ------------------------------------- */
    /* Base & Utilities            */
    /* ------------------------------------- */
    :root {
        --primary-color: #2a2e92;
        --secondary-color: #00f0ff;
        --background-dark: #0a0f1f;
        --card-background: rgba(35, 40, 60, 0.8);
        --text-light: #e0e0e0;
        --border-color: rgba(0, 240, 255, 0.2);
    }
    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', sans-serif;
        color: var(--text-light);
        background-color: var(--background-dark);
        transition: background-color 0.3s, color 0.3s;
    }
    * { box-sizing: border-box; }
    h1, h2, h3, h4 { color: var(--secondary-color); margin-bottom: 10px; }
    a { text-decoration: none; color: var(--secondary-color); }
    main {
        display: flex;
        height: calc(100vh - 60px);
    }
    
    /* ------------------------------------- */
    /* Header                 */
    /* ------------------------------------- */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 20px;
        background-color: var(--background-dark);
        border-bottom: 2px solid var(--secondary-color);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        position: sticky;
        top: 0;
        z-index: 1000;
        height: 60px;
    }
    .header h1 {
        font-size: 24px;
        margin: 0;
    }
    .header .user-menu {
        position: relative;
    }
    .user-menu .profile-btn {
        background: none;
        border: none;
        color: var(--secondary-color);
        font-size: 26px;
        cursor: pointer;
        transition: color 0.3s;
    }
    .user-menu .profile-btn:hover { color: white; }
    .dropdown-menu {
        position: absolute;
        top: 40px;
        right: 0;
        background-color: var(--card-background);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        display: none;
        flex-direction: column;
        z-index: 1000;
        min-width: 180px;
        overflow: hidden;
    }
    .dropdown-menu button {
        background: none;
        border: none;
        color: var(--text-light);
        padding: 12px 15px;
        text-align: left;
        cursor: pointer;
        transition: background-color 0.2s;
        font-size: 16px;
    }
    .dropdown-menu button:hover { background-color: rgba(0, 240, 255, 0.2); }
    .dropdown-menu button i { margin-right: 10px; }

    /* ------------------------------------- */
    /* Sidebar (Left Column)       */
    /* ------------------------------------- */
    .sidebar {
        width: 300px;
        background-color: rgba(10, 15, 31, 0.9);
        padding: 20px;
        border-right: 1px solid var(--border-color);
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 20px;
    }
    .sidebar .user-profile {
        text-align: center;
        margin-bottom: 20px;
        padding-bottom: 20px;
        border-bottom: 1px solid var(--border-color);
    }
    .user-profile img {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        border: 3px solid var(--secondary-color);
        object-fit: cover;
    }
    .user-profile h3 { margin-top: 10px; font-size: 1.5rem; }
    .user-profile p { font-size: 0.9rem; color: #aaa; }
    .sidebar-section {
        background: var(--card-background);
        border-radius: 10px;
        padding: 20px;
        border: 1px solid var(--border-color);
    }
    .sidebar-section h4 { margin-top: 0; }
    .progress-bar {
        height: 10px;
        background-color: rgba(255,255,255,0.2);
        border-radius: 5px;
        margin-top: 10px;
        overflow: hidden;
    }
    .progress-bar-fill {
        height: 100%;
        width: 75%; /* Example progress */
        background-color: var(--secondary-color);
        border-radius: 5px;
    }
    .quick-links-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 10px;
        text-align: center;
    }
    .quick-links-grid a {
        display: block;
        padding: 15px 10px;
        background: var(--primary-color);
        border-radius: 8px;
        transition: transform 0.3s;
        font-size: 0.9rem;
    }
    .quick-links-grid a:hover { transform: translateY(-5px); background: #1e2478; }
    .quick-links-grid i { font-size: 1.5rem; margin-bottom: 5px; display: block; }
    .study-timer-display { font-size: 2.5rem; text-align: center; }
    .study-timer-controls { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }
    .study-timer-controls button {
        padding: 8px 16px;
        font-size: 1rem;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        background-color: var(--primary-color);
        color: white;
    }

    /* ------------------------------------- */
    /* Main Content (Right Column) */
    /* ------------------------------------- */
    .content-area {
        flex-grow: 1;
        padding: 20px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 25px;
        max-width: 900px;
        margin: 0 auto;
    }
    .announcement-banner {
        padding: 15px;
        background-color: var(--secondary-color);
        color: #333;
        text-align: center;
        font-weight: bold;
        border-radius: 8px;
        animation: pulse 2s infinite;
    }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
    .search-bar {
        display: flex;
        gap: 10px;
    }
    .search-bar input {
        flex-grow: 1;
        padding: 10px 20px;
        border-radius: 25px;
        border: 2px solid var(--secondary-color);
        background-color: rgba(0, 0, 0, 0.2);
        color: var(--text-light);
        outline: none;
    }
    .search-bar button {
        padding: 10px 20px;
        border: none;
        background-color: var(--secondary-color);
        color: var(--background-dark);
        border-radius: 25px;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    .search-bar button:hover { background-color: #00c0cc; }
    .resource-card {
        background: var(--card-background);
        border-radius: 10px;
        padding: 20px;
        border: 1px solid var(--border-color);
        display: flex;
        flex-direction: column;
        gap: 10px;
        transition: transform 0.3s;
        cursor: pointer; /* Added for clickable cards */
    }
    .resource-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0, 240, 255, 0.2); }
    .resource-card h4 {
        margin: 0;
        font-size: 1.2rem;
    }
    .resource-card .meta {
        font-size: 0.9rem;
        color: #aaa;
    }
    .resource-card .meta span { margin-right: 15px; }
    .resource-card .actions {
        display: flex;
        gap: 10px;
        margin-top: 10px;
    }
    .resource-card .actions button {
        padding: 8px 15px;
        border-radius: 20px;
        border: none;
        cursor: pointer;
        font-weight: bold;
        transition: background-color 0.3s;
    }
    .resource-card .actions .view-btn {
        background-color: var(--primary-color);
        color: white;
    }
    .resource-card .actions .download-btn {
        background-color: var(--secondary-color);
        color: var(--background-dark);
    }
    .featured-resource {
        background: linear-gradient(45deg, #1e2478, #2a2e92);
        border: 2px solid var(--secondary-color);
    }

    .explore-section {
        background: var(--card-background);
        border-radius: 10px;
        padding: 20px;
        border: 1px solid var(--border-color);
    }
    .back-btn {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        cursor: pointer;
        transition: 0.3s;
    }
    .back-btn:hover {
        background: #1e2478;
    }
    .selection-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
        text-align: center;
    }

    /* ------------------------------------- */
    /* Footer                */
    /* ------------------------------------- */
    .footer {
        padding: 20px;
        background-color: var(--background-dark);
        text-align: center;
        border-top: 2px solid var(--secondary-color);
        color: #aaa;
    }
    .social-icons a {
        margin: 0 10px;
        font-size: 22px;
        color: var(--secondary-color);
        transition: transform 0.3s;
    }
    .social-icons a:hover { transform: scale(1.2); }

    /* ------------------------------------- */
    /* Responsive               */
    /* ------------------------------------- */
    @media (max-width: 900px) {
        main { flex-direction: column; }
        .sidebar {
            width: 100%;
            border-right: none;
            border-bottom: 1px solid var(--border-color);
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 15px;
        }
        .sidebar .user-profile, .sidebar-section {
            width: 45%;
            margin-bottom: 15px;
        }
        .user-profile img { width: 60px; height: 60px; }
        .user-profile h3 { font-size: 1.2rem; }
        .user-profile p { display: none; }
    }
    @media (max-width: 600px) {
        .sidebar { flex-direction: column; }
        .sidebar .user-profile, .sidebar-section { width: 100%; }
        .header h1 { font-size: 20px; }
        .selection-grid { grid-template-columns: 1fr; }
    }
  </style>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>
  
  <div class="header">
    <h1>High Stars Aimers</h1>
    <div class="user-menu">
        <button class="profile-btn" onclick="toggleDropdown()"><i class="fas fa-user-circle"></i></button>
        <div id="dropdownMenu" class="dropdown-menu">
            <button onclick="window.location.href='profile.html'"><i class="fas fa-user-cog"></i> Profile Settings</button>
            <button onclick="window.location.href='contact.html'"><i class="fas fa-headset"></i> Support</button>
            <button onclick="window.location.href='privacy.html'"><i class="fas fa-shield-alt"></i> Privacy & Policy</button>
            <button onclick="logout()"><i class="fas fa-sign-out-alt"></i> Sign Out</button>
        </div>
    </div>
  </div>
  
  <main>
    <aside class="sidebar">
        <div class="user-profile">
            <img id="userProfilePic" src="https://i.postimg.cc/85z11v37/user-profile-pic.png" alt="Profile Picture">
            <h3 id="welcomeMessage">Welcome, User!</h3>
            <p id="userEmail">Loading...</p>
        </div>
        
        <div class="sidebar-section">
            <h4>My Progress</h4>
            <div class="progress-bar">
                <div class="progress-bar-fill" style="width: 75%;"></div>
            </div>
            <small>75% of your learning goals completed!</small>
        </div>
        
        <div class="sidebar-section">
            <h4>Quick Links</h4>
            <div class="quick-links-grid">
                <a href="#" onclick="showMainContent()"><i class="fas fa-home"></i><span>Home</span></a>
                <a href="#" onclick="alert('Quiz feature coming soon!')"><i class="fas fa-question-circle"></i><span>Quiz</span></a>
                <a href="#" onclick="alert('Timer feature coming soon!')"><i class="fas fa-clock"></i><span>Timer</span></a>
            </div>
        </div>
        
        <div class="sidebar-section">
            <h4>Today's Tip</h4>
            <p id="studyTip">"Break down large tasks into smaller, manageable chunks."</p>
        </div>
    </aside>
    
    <div class="content-area">
        <div class="announcement-banner">
            <i class="fas fa-bullhorn"></i> New updates are here! Check out the latest past papers.
        </div>
        
        <div id="featured-content-section">
            <h2 id="content-title">Featured Content</h2>
            <div class="resource-card featured-resource">
                <h4>KCSE 2024 Mathematics Paper</h4>
                <p style="font-style: italic; color: #ccc;">A comprehensive paper from the latest KCSE exams, focusing on core concepts.</p>
                <div class="meta">
                    <span><i class="fas fa-calendar-alt"></i> Year: 2024</span>
                    <span><i class="fas fa-tag"></i> Subject: Mathematics</span>
                    <span><i class="fas fa-dollar-sign"></i> Price: Free</span>
                </div>
                <div class="actions">
                    <button class="view-btn"><i class="fas fa-eye"></i> View</button>
                    <button class="download-btn" onclick="downloadFile()"><i class="fas fa-download"></i> Download</button>
                </div>
            </div>
        </div>
        
        <div id="dynamic-content-section">
             <h2 id="dynamic-content-title"></h2>
             <div id="selection-grid" class="selection-grid">
                 </div>
        </div>

        <div id="resource-display-section" style="display: none;">
            <button class="back-btn" onclick="showSubjects()">
                <i class="fas fa-arrow-left"></i> Back to Subjects
            </button>
            <h2 id="resources-title">Filtered Resources</h2>
            <div id="resource-grid" class="selection-grid">
                </div>
        </div>
    </div>
  </main>
  
  <footer class="footer">
    <div class="social-icons">
      <a href="#"><i class="fab fa-facebook"></i></a>
      <a href="#"><i class="fab fa-instagram"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-youtube"></i></a>
      <a href="#"><i class="fab fa-tiktok"></i></a>
      <a href="#"><i class="fab fa-whatsapp"></i></a>
    </div>
    <div class="footer-links">
      <a href="#">About Us</a> | <a href="#">FAQs</a> | <a href="#">Terms & Conditions</a>
    </div>
    <p>&copy; <span id="currentYear"></span> High Stars Aimers. All Rights Reserved.</p>
  </footer>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDhJD5Ux22U393z6RqT4Nv570jqoNrg7Xc",
      authDomain: "high-stars-aimers-5972f.firebaseapp.com",
      projectId: "high-stars-aimers-5972f",
      storageBucket: "high-stars-aimers-5972f.firebasestorage.app",
      messagingSenderId: "233345875942",
      appId: "1:233345875942:web:cf7610de84f0b2262ce027",
      measurementId: "G-X475KTSH5J"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    const dropdownMenu = document.getElementById('dropdownMenu');
    const featuredContentSection = document.getElementById('featured-content-section');
    const dynamicContentSection = document.getElementById('dynamic-content-section');
    const resourceDisplaySection = document.getElementById('resource-display-section');
    const dynamicContentTitle = document.getElementById('dynamic-content-title');
    const selectionGrid = document.getElementById('selection-grid');
    const resourceGrid = document.getElementById('resource-grid');
    const welcomeMessage = document.getElementById('welcomeMessage');
    const userEmail = document.getElementById('userEmail');

    // State management for navigation
    let currentSubject = null;
    let currentYear = null;

    function toggleDropdown() {
      dropdownMenu.style.display = dropdownMenu.style.display === 'flex' ? 'none' : 'flex';
    }

    function logout() {
      auth.signOut().then(() => {
        window.location.href = 'signin1.html';
      });
    }
    
    function downloadFile(url, fileName) {
        const a = document.createElement('a');
        a.href = url;
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }
    
    function showMainContent() {
        featuredContentSection.style.display = 'block';
        dynamicContentSection.style.display = 'none';
        resourceDisplaySection.style.display = 'none';
        showSubjects();
    }

    function showSubjects() {
        featuredContentSection.style.display = 'none';
        dynamicContentSection.style.display = 'block';
        resourceDisplaySection.style.display = 'none';

        dynamicContentTitle.textContent = "Explore Subjects";
        selectionGrid.innerHTML = '';
        
        const subjects = ['Physics', 'Chemistry', 'Biology', 'Mathematics'];
        subjects.forEach(subject => {
            const card = document.createElement('div');
            card.className = 'resource-card';
            card.innerHTML = `<h4>${subject}</h4>`;
            card.onclick = () => showYears(subject);
            selectionGrid.appendChild(card);
        });
    }

    function showYears(subject) {
        currentSubject = subject;
        dynamicContentTitle.textContent = `Select Year for ${subject}`;
        selectionGrid.innerHTML = '';
        
        const backBtn = document.createElement('button');
        backBtn.className = 'back-btn';
        backBtn.innerHTML = '<i class="fas fa-arrow-left"></i> Back to Subjects';
        backBtn.onclick = showSubjects;
        selectionGrid.appendChild(backBtn);
        
        for (let i = 2025; i >= 2015; i--) {
            const card = document.createElement('div');
            card.className = 'resource-card';
            card.innerHTML = `<h4>Year ${i}</h4>`;
            card.onclick = () => showTerms(subject, i);
            selectionGrid.appendChild(card);
        }
    }

    function showTerms(subject, year) {
        currentYear = year;
        dynamicContentTitle.textContent = `Select Term for ${subject} ${year}`;
        selectionGrid.innerHTML = '';
        
        const backBtn = document.createElement('button');
        backBtn.className = 'back-btn';
        backBtn.innerHTML = '<i class="fas fa-arrow-left"></i> Back to Years';
        backBtn.onclick = () => showYears(subject);
        selectionGrid.appendChild(backBtn);

        const terms = ['Term 1', 'Term 2', 'Term 3'];
        terms.forEach(term => {
            const card = document.createElement('div');
            card.className = 'resource-card';
            card.innerHTML = `<h4>${term}</h4>`;
            card.onclick = () => showFilteredResources(subject, year, term);
            selectionGrid.appendChild(card);
        });
    }

    function showFilteredResources(subject, year, term) {
        dynamicContentSection.style.display = 'none';
        resourceDisplaySection.style.display = 'block';
        
        document.getElementById('resources-title').textContent = `${subject} ${year} ${term}`;
        resourceGrid.innerHTML = '';
        
        const uploads = JSON.parse(localStorage.getItem('uploads') || '[]');
        const filtered = uploads.filter(u => u.subject === subject && u.year == year);

        if (filtered.length === 0) {
            resourceGrid.innerHTML = '<p style="text-align: center; width: 100%;">No resources found for this selection.</p>';
        } else {
            filtered.forEach(u => {
                const card = document.createElement('div');
                card.className = 'resource-card';
                card.innerHTML = `
                    <