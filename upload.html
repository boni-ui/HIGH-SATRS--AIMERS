<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High Stars Aimers - Upload Portal</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --primary-color: #2a2e92;
  --secondary-color: #00f0ff;
  --background-dark: #0a0f1f;
  --card-background: rgba(35, 40, 60, 0.8);
  --text-light: #e0e0e0;
  --border-color: rgba(0, 240, 255, 0.2);
}
html, body {
  margin:0; padding:0;
  font-family:'Segoe UI', sans-serif;
  background-color: var(--background-dark);
  color: var(--text-light);
}
.header {
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 20px;
  background-color: var(--background-dark);
  border-bottom:2px solid var(--secondary-color);
}
.header a { color:white; text-decoration:none; }
main { padding:30px; max-width:700px; margin:0 auto; }
h2 { color: var(--secondary-color); margin-bottom:20px; text-align:center; }
.upload-card {
  background: var(--card-background);
  padding:25px 30px;
  border-radius:10px;
  border:1px solid var(--border-color);
  box-shadow:0 4px 12px rgba(0,240,255,0.1);
}
label {
  display:block; margin-top:15px; margin-bottom:5px;
  color: var(--secondary-color); font-weight:600;
}
select, input[type="file"], button {
  width:100%; padding:10px; background-color:#151a2f;
  border:1px solid var(--border-color); color:var(--text-light);
  border-radius:6px; margin-bottom:15px; font-size:16px;
}
button {
  background-color: var(--secondary-color);
  color:#000; font-weight:bold; cursor:pointer; border:none; transition:0.3s;
}
button:hover { background-color:#03e3f0; transform:scale(1.02); }
.progress-bar {
  width: 0; height: 8px;
  background-color: var(--secondary-color);
  border-radius: 4px; margin-top: 10px; transition: width 0.3s;
}
.footer {
  text-align:center; padding:20px;
  border-top:2px solid var(--secondary-color);
  color:#aaa; margin-top:40px;
}
</style>
</head>
<body>
<div class="header">
  <h1>High Stars Aimers</h1>
  <a href="index.html"><i class="fas fa-arrow-left"></i> Back Home</a>
</div>

<main>
  <h2>Upload Portal</h2>
  <div class="upload-card">
    <form id="uploadForm">
      <label for="uploadType">Select Upload Type:</label>
      <select id="uploadType" required>
        <option value="">-- Select Type --</option>
        <option value="notes">Notes</option>
        <option value="papers">Papers</option>
      </select>

      <div id="subjectDiv">
        <label for="subject">Select Subject:</label>
        <select id="subject" required>
          <option value="">-- Select Subject --</option>
          <option>Mathematics</option>
          <option>English</option>
          <option>Kiswahili</option>
          <option>Biology</option>
          <option>Chemistry</option>
          <option>Physics</option>
          <option>Geography</option>
          <option>History</option>
          <option>CRE</option>
          <option>Business Studies</option>
          <option>Agriculture</option>
          <option>Computer Studies</option>
        </select>
      </div>

      <div id="formDiv">
        <label for="form">Select Form:</label>
        <select id="form" required>
          <option value="">-- Select Form --</option>
          <option>Form 1</option>
          <option>Form 2</option>
          <option>Form 3</option>
          <option>Form 4</option>
        </select>
      </div>

      <label for="file">Choose File (PDF):</label>
      <input type="file" id="file" accept=".pdf" required>

      <div class="progress-bar" id="progressBar"></div>
      <p id="uploadStatus"></p>

      <button type="submit">Upload File</button>
    </form>
  </div>
</main>

<footer class="footer">
  &copy; 2025 High Stars Aimers. All Rights Reserved.
</footer>

<script>
const CLOUD_NAME = "dj8xycoww";
const UPLOAD_PRESET = "highstars_upload";

const uploadForm = document.getElementById("uploadForm");
const progressBar = document.getElementById("progressBar");
const uploadStatus = document.getElementById("uploadStatus");

uploadForm.addEventListener("submit", async (e) => {
  e.preventDefault();

  const type = document.getElementById("uploadType").value;
  const subject = document.getElementById("subject").value;
  const form = document.getElementById("form").value;
  const file = document.getElementById("file").files[0];

  if (!type || !subject || !form || !file) {
    alert("Please fill all fields.");
    return;
  }

  const formData = new FormData();
  formData.append("file", file);
  formData.append("upload_preset", UPLOAD_PRESET);
  formData.append("folder", `${type}/${form}/${subject}`);

  uploadStatus.textContent = "⏳ Uploading...";
  progressBar.style.width = "0%";

  const xhr = new XMLHttpRequest();
  xhr.open("POST", `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/auto/upload`, true);

  xhr.upload.onprogress = (event) => {
    if (event.lengthComputable) {
      const percent = (event.loaded / event.total) * 100;
      progressBar.style.width = percent + "%";
      uploadStatus.textContent = `Uploading... ${Math.round(percent)}%`;
    }
  };

  xhr.onload = () => {
    if (xhr.status === 200) {
      const response = JSON.parse(xhr.responseText);
      const fileUrl = response.secure_url;
      uploadStatus.textContent = "✅ Uploaded successfully!";
      console.log("File URL:", fileUrl);
    } else {
      uploadStatus.textContent = "❌ Upload failed.";
    }
  };

  xhr.onerror = () => {
    uploadStatus.textContent = "❌ Upload failed due to network error.";
  };

  xhr.send(formData);
});
</script>
</body>
</html>