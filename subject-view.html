<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>High Stars Aimers - Subject View</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    :root {
      --primary-color: #2a2e92;
      --secondary-color: #00f0ff;
      --background-dark: #0a0f1f;
      --card-background: rgba(35, 40, 60, 0.8);
      --text-light: #e0e0e0;
      --border-color: rgba(0, 240, 255, 0.2);
    }
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      color: var(--text-light);
      background-color: var(--background-dark);
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: var(--background-dark);
      border-bottom: 2px solid var(--secondary-color);
    }
    .header a { color: white; text-decoration: none; }
    main {
      padding: 30px;
      max-width: 900px;
      margin: 0 auto;
    }
    h2 {
      color: var(--secondary-color);
      margin-bottom: 20px;
    }
    .topic-card {
      background: var(--card-background);
      padding: 20px;
      margin-bottom: 15px;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      cursor: pointer;
      position: relative;
    }
    .topic-card:hover { box-shadow: 0 8px 20px rgba(0, 240, 255, 0.2); }
    .topic-card h3 { margin: 0; }
    .dropdown {
      display: none;
      margin-top: 10px;
      padding-left: 15px;
      border-left: 2px solid var(--secondary-color);
    }
    .dropdown a {
      display: block;
      color: var(--text-light);
      padding: 5px 0;
      text-decoration: none;
    }
    .dropdown a:hover { color: var(--secondary-color); }
    .footer {
      text-align: center;
      padding: 20px;
      border-top: 2px solid var(--secondary-color);
      color: #aaa;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>High Stars Aimers</h1>
    <a href="subjects.html"><i class="fas fa-arrow-left"></i> Back to Subjects</a>
  </div>

  <main>
    <h2 id="subject-title">Subject: </h2>
    <div id="topics-container"></div>
  </main>

  <footer class="footer">
    &copy; 2025 High Stars Aimers. All Rights Reserved.
  </footer>

  <!-- Firebase Integration -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyCgbZprjmoVtouXN2iI83X8MqVuTjbp5H8",
      authDomain: "high-stars-aimers-844a6.firebaseapp.com",
      databaseURL: "https://high-stars-aimers-844a6-default-rtdb.firebaseio.com",
      projectId: "high-stars-aimers-844a6",
      storageBucket: "high-stars-aimers-844a6.firebasestorage.app",
      messagingSenderId: "10463765487",
      appId: "1:10463765487:web:a2ae29377493a7b7d2cc1a"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const syllabus = {
      "Mathematics": {
        1: ["Numbers & Operations", "Algebra Basics", "Geometry Fundamentals", "Statistics Intro"],
        2: ["Algebra II", "Trigonometry Basics", "Plane Geometry", "Probability"],
        3: ["Advanced Algebra", "Coordinate Geometry", "Mensuration", "Statistics & Probability"],
        4: ["Calculus Intro", "Advanced Trigonometry", "Vectors", "Matrices"]
      },
      "Chemistry": {
        1: ["Matter & Properties", "Atoms & Molecules", "States of Matter", "Solutions Basics"],
        2: ["Chemical Reactions", "Acids & Bases", "Metals & Non-metals", "Organic Intro"],
        3: ["Organic Chemistry", "Chemical Bonding", "Periodic Table", "Electrochemistry"],
        4: ["Analytical Chemistry", "Physical Chemistry", "Industrial Chemistry", "Environmental Chemistry"]
      }
      // (Add your other subjects)
    };

    const params = new URLSearchParams(window.location.search);
    const subject = params.get("subject") || "Mathematics";
    const form = params.get("form") || "1";
    document.getElementById("subject-title").innerText = `Subject: ${subject} - Form ${form}`;
    const topicsContainer = document.getElementById("topics-container");

    syllabus[subject][form].forEach(async (topic) => {
      const card = document.createElement("div");
      card.className = "topic-card";
      card.innerHTML = `<h3>${topic}</h3><div class="dropdown"><p>Loading...</p></div>`;
      const dropdown = card.querySelector(".dropdown");

      const notesRef = ref(db, `notes/${subject}/${form}/${topic}`);

      try {
        const snapshot = await get(notesRef);
        dropdown.innerHTML = "";
        if (snapshot.exists()) {
          const files = snapshot.val();
          for (const key in files) {
            const note = files[key];
            const link = document.createElement("a");
            link.href = note.url;
            link.target = "_blank";
            link.textContent = note.name || "View Note";
            dropdown.appendChild(link);
          }
        } else {
          dropdown.innerHTML = "<a href='#'>No notes uploaded yet</a>";
        }
      } catch (error) {
        dropdown.innerHTML = "<p style='color:red'>Error loading notes</p>";
      }

      card.addEventListener("click", () => {
        dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
      });

      topicsContainer.appendChild(card);
    });
  </script>
</body>
</html>