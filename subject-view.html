<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High Stars Aimers - Subject View</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --primary-color: #2a2e92;
  --secondary-color: #00f0ff;
  --background-dark: #0a0f1f;
  --card-background: rgba(35, 40, 60, 0.8);
  --text-light: #e0e0e0;
  --border-color: rgba(0, 240, 255, 0.2);
}
html, body {margin:0;padding:0;font-family:'Segoe UI', sans-serif;color:var(--text-light);background-color:var(--background-dark);}
.header {display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background-color:var(--background-dark);border-bottom:2px solid var(--secondary-color);}
.header a { color:white;text-decoration:none; }
main {padding:30px;max-width:900px;margin:0 auto;}
h2 {color:var(--secondary-color);margin-bottom:20px;}
.topic-card {background:var(--card-background);padding:20px;margin-bottom:15px;border-radius:12px;border:1px solid var(--border-color);cursor:pointer;position:relative;}
.topic-card:hover {box-shadow:0 8px 20px rgba(0,240,255,0.2);}
.topic-card h3 {margin:0;}
.file-list {margin-top:10px;}
.file-list a {display:block;color:var(--text-light);text-decoration:none;padding:5px 0;}
.file-list a:hover {color:var(--secondary-color);}
.footer {text-align:center;padding:20px;border-top:2px solid var(--secondary-color);color:#aaa;margin-top:30px;}
</style>
</head>
<body>

<div class="header">
  <h1>High Stars Aimers</h1>
  <a href="subjects.html"><i class="fas fa-arrow-left"></i> Back to Subjects</a>
</div>

<main>
  <h2 id="subject-title">Subject: </h2>
  <div id="topics-container"></div>
</main>

<footer class="footer">
  &copy; 2025 High Stars Aimers. All Rights Reserved.
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyCgbZprjmoVtouXN2iI83X8MqVuTjbp5H8",
  authDomain: "high-stars-aimers-844a6.firebaseapp.com",
  databaseURL: "https://high-stars-aimers-844a6-default-rtdb.firebaseio.com/",
  projectId: "high-stars-aimers-844a6",
  storageBucket: "high-stars-aimers-844a6.appspot.com",
  messagingSenderId: "10463765487",
  appId: "1:10463765487:web:a2ae29377493a7b7d2cc1a"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Full syllabus for all subjects/forms
const syllabus = {
  "Mathematics": {
    "Form 1": ["Numbers","Algebra","Geometry","Mensuration","Statistics","Trigonometry"],
    "Form 2": ["Algebra II","Trigonometry","Plane Geometry","Probability","Statistics"],
    "Form 3": ["Advanced Algebra","Coordinate Geometry","Mensuration","Statistics","Probability","Trigonometry"],
    "Form 4": ["Calculus","Advanced Trigonometry","Vectors","Matrices","Probability"]
  },
  "English": {
    "Form 1": ["Grammar","Comprehension","Writing","Oral Skills","Literature"],
    "Form 2": ["Grammar II","Comprehension II","Writing II","Oral Skills II","Literature II"],
    "Form 3": ["Grammar III","Comprehension III","Writing III","Oral Skills III","Literature III"],
    "Form 4": ["Advanced Grammar","Advanced Comprehension","Advanced Writing","Advanced Oral Skills","Literature IV"]
  }
  // add all other subjects similarly...
};

// Read URL parameters
const params = new URLSearchParams(window.location.search);
const subject = params.get("subject") || "Mathematics";
const form = params.get("form") || "Form 1";

document.getElementById("subject-title").innerText = `Subject: ${subject} - ${form}`;
const topicsContainer = document.getElementById("topics-container");

// Function to create topic cards and fetch uploaded files
async function displayTopics() {
  const topics = syllabus[subject][form];
  for (let topic of topics) {
    const card = document.createElement("div");
    card.className = "topic-card";
    card.innerHTML = `<h3>${topic}</h3><div class="file-list"><p>Loading files...</p></div>`;
    const fileList = card.querySelector(".file-list");

    // Check both notes and papers
    const types = ["notes", "papers"];
    fileList.innerHTML = ""; // clear loading text

    for (let type of types) {
      const pathRef = ref(db, `${type}/${subject}/${form}/${topic}`);
      const snapshot = await get(pathRef);
      if (snapshot.exists()) {
        const files = snapshot.val();
        for (let key in files) {
          const file = files[key];
          const a = document.createElement("a");
          a.href = file.url || "#";
          a.target = "_blank";
          a.textContent = `[${type}] ${file.fileName}`;
          fileList.appendChild(a);
        }
      }
    }

    // If no files
    if (!fileList.hasChildNodes()) {
      fileList.innerHTML = "<p>No files uploaded yet.</p>";
    }

    topicsContainer.appendChild(card);
  }
}

// Load topics and files
displayTopics();
</script>
</body>
</html>