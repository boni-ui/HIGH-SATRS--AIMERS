<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Subject View</title>
<style>
  body { font-family: sans-serif; background: #0a0f1f; color: #e0e0e0; padding: 20px; }
  h1 { color: #00f0ff; }
  ul { list-style: none; padding: 0; }
  li { margin: 10px 0; }
  a { color: #00f0ff; text-decoration: none; }
  a:hover { text-decoration: underline; }
</style>
</head>
<body>
<h1 id="title">Loading...</h1>
<ul id="fileList"></ul>

<script>
// Get query parameters from URL
const urlParams = new URLSearchParams(window.location.search);
const subject = urlParams.get('subject'); // e.g., Mathematics
const form = urlParams.get('form');       // e.g., 1

document.getElementById('title').innerText = `${subject} - Form ${form}`;

// Cloudinary details
const cloudName = 'dj8xycoww';
const unsignedPreset = 'high stars subjects';
const folderPath = `subjects/${subject}/f${form}`;

// Cloudinary search URL (unsigned)
const searchUrl = `https://res.cloudinary.com/${cloudName}/search/sort_by=public_id:asc/expression=folder:${folderPath} AND resource_type:raw?max_results=100&upload_preset=${unsignedPreset}`;

fetch(searchUrl)
.then(res => res.json())
.then(data => {
    const list = document.getElementById('fileList');
    if (!data.resources || data.resources.length === 0) {
        list.innerHTML = '<li>No files found in this folder.</li>';
        return;
    }
    data.resources.forEach(file => {
        const li = document.createElement('li');
        li.innerHTML = `<a href="${file.secure_url}" target="_blank">${file.filename}</a>`;
        list.appendChild(li);
    });
})
.catch(err => {
    console.error(err);
    document.getElementById('fileList').innerHTML = '<li>Error loading files.</li>';
});
</script>
</body>
</html>